{"version":3,"sources":["./$_lazy_route_resource lazy namespace object","./src/app/app.component.html","./src/app/editor-panel/editor-panel.component.html","./src/app/layer-panel/layer-panel.component.html","./src/app/layer-panel/layer-select/layer-select.component.html","./src/app/particle-editor/particle-editor.component.html","./src/app/preview-panel/preview-panel.component.html","./src/app/tool-panel/direction-color-picker/direction-color-picker.component.html","./src/app/tool-panel/tool-panel.component.html","./node_modules/tslib/tslib.es6.js","./src/app/app.component.css","./src/app/app.component.ts","./src/app/app.module.ts","./src/app/editor-panel/editor-panel.component.css","./src/app/editor-panel/editor-panel.component.ts","./src/app/layer-panel/layer-panel.component.css","./src/app/layer-panel/layer-panel.component.ts","./src/app/layer-panel/layer-select/layer-select.component.css","./src/app/layer-panel/layer-select/layer-select.component.ts","./src/app/particle-editor/particle-editor.component.css","./src/app/particle-editor/particle-editor.component.ts","./src/app/preview-panel/preview-panel.component.css","./src/app/preview-panel/preview-panel.component.ts","./src/app/preview-panel/renderer.ts","./src/app/services/layer.ts","./src/app/services/morphlayer.ts","./src/app/services/particlelayer.ts","./src/app/services/particles/emitter.ts","./src/app/services/particles/particle.ts","./src/app/services/particles/particlesystem.ts","./src/app/services/project-data.service.ts","./src/app/services/utils.ts","./src/app/tool-panel/direction-color-picker/direction-color-picker.component.css","./src/app/tool-panel/direction-color-picker/direction-color-picker.component.ts","./src/app/tool-panel/tool-panel.component.css","./src/app/tool-panel/tool-panel.component.ts","./src/environments/environment.ts","./src/main.ts"],"names":[],"mappings":"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","file":"main-es2015.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./$$_lazy_route_resource lazy recursive\";","export default \"<div class=\\\"mainFlex\\\">\\n  <app-editor-panel [ngClass]=\\\"{'hidden': !pds.curLayer || pds.curLayer.type !== LayerType.MorphLayer}\\\"  class=\\\"flexGrow  card roundPanel\\\" (scroll)=\\\"scroll($event)\\\" #editorPanel></app-editor-panel>\\n  <app-particle-editor [ngClass]=\\\"{'hidden': !pds.curLayer || pds.curLayer.type !== LayerType.ParticleLayer}\\\"  class=\\\"flexGrow  card roundPanel\\\" #editorPanel></app-particle-editor>\\n  <div class=\\\"centerPanel\\\">\\n    <app-tool-panel class=\\\"flexGrow roundPanel card\\\"></app-tool-panel>\\n    <app-layer-panel class=\\\"flexGrow roundPanel card\\\"></app-layer-panel>\\n  </div>\\n  <app-preview-panel class=\\\"flexGrow roundPanel card\\\" (scroll)=\\\"scroll($event)\\\" #previewPanel></app-preview-panel>\\n</div>\\n\"","export default \"<canvas id=\\\"previewCanvas\\\" #previewCanvas></canvas>\\n<canvas #flowmapCanvas style=\\\"display: none;\\\"></canvas>\\n\"","export default \"<div class=\\\"flexContainer\\\">\\n  <div class=\\\"layers\\\">\\n    <app-layer-select *ngFor=\\\"let layer of pds.layers\\\" [layer]=\\\"layer\\\"></app-layer-select>\\n  </div>\\n  <div class=\\\"toolbar\\\">\\n    <button type=\\\"button\\\" (click)=\\\"newLayerVisible=true\\\">+</button>\\n    <button style=\\\"float: right;\\\" (click)=\\\"pds.moveLayerDown();\\\"> down </button>\\n    <button style=\\\"float: right;\\\" (click)=\\\"pds.moveLayerUp();\\\"> up </button>\\n    <button style=\\\"float: right;\\\" (click)=\\\"pds.deleteCurrentLayer();\\\"> X </button>\\n  </div>\\n</div>\\n<div id=\\\"dialogBack\\\" (click)=\\\"newLayerVisible = false;\\\" [ngClass]=\\\"{'hidden':!newLayerVisible}\\\">\\n  <div id=\\\"newLayerDialog\\\" (click)=\\\"$event.stopPropagation()\\\">\\n    <button type=\\\"button\\\" (click)=\\\"selectLayerType('morph')\\\">MorphLayer</button>\\n    <button type=\\\"button\\\" (click)=\\\"selectLayerType('particle')\\\">ParticleLayer</button><br>\\n    <hr>\\n    <label>Layer Name:</label><br/>\\n    <input type=\\\"text\\\" placeholder=\\\"Enter layer name\\\" #layerNameInput/> <br/><br/>\\n    <div id=\\\"morphInput\\\">\\n      <select id=\\\"morphType\\\" size=\\\"2\\\">\\n          <option selected>flow</option>\\n          <option>wave</option>\\n      </select><br><br>\\n      <label>Image File:</label><br/>\\n      <input type=\\\"file\\\" #imageLoader name=\\\"imageLoader\\\"/><br><br>\\n      <canvas #imageCanvas></canvas><br>\\n      <button type=\\\"button\\\" style=\\\"float: right;\\\" (click)=\\\"createLayer()\\\">create new layer</button>\\n    </div>\\n\\n    <div id=\\\"particleInput\\\" style=\\\"display: none;\\\"><br><br>\\n      <button type=\\\"button\\\" style=\\\"float: right;\\\"  (click)=\\\"createParticleLayer()\\\">create new particle layer</button>\\n    </div>\\n\\n\\n  </div>\\n</div>\\n\"","export default \"<div (click)=\\\"selectLayer()\\\" class=\\\"host\\\" [ngClass]=\\\"{'selected': pds.curLayer == layer}\\\">\\n  {{layer.name}}\\n</div>\\n\"","export default \"<div *ngFor=\\\"let emitter of getParticleLayer().emitters\\\">\\n  <b>{{emitter.readableName}}</b>\\n  <div *ngFor=\\\"let field of emitter.fields\\\">\\n    {{field.name}}: <input value=\\\"{{emitter[field.key]}}\\\" (change)=\\\"updateEmitter(emitter, field.key, $event)\\\">\\n  </div>\\n\\n</div>\\n<div *ngFor=\\\"let pf of getParticleLayer().particleFactories\\\">\\n  <b>{{pf.readableName}}</b>\\n  <div *ngFor=\\\"let field of pf.fields\\\">\\n    <ng-container *ngIf=\\\"field.type === 'number'\\\">\\n      {{field.name}}: <input value=\\\"{{pf[field.key]}}\\\" (change)=\\\"updateEmitter(pf, field.key, $event)\\\">\\n    </ng-container>\\n    <ng-container *ngIf=\\\"field.type === 'image'\\\">\\n      <label>{{field.name}}:</label><br/>\\n      <input type=\\\"file\\\" #imageLoader name=\\\"imageLoader\\\" (change)=\\\"updateImage(pf, field.key, $event)\\\"/><br>\\n    </ng-container>\\n  </div>\\n\\n</div>\\n\"","export default \"<canvas id=\\\"CanvasFinal\\\" style=\\\"background-color: #aaaaaa\\\" #CanvasFinal></canvas>\\n\"","export default \"<canvas #canvas></canvas>\\n\"","export default \"Select direction:\\n<app-direction-color-picker></app-direction-color-picker><br><br>\\nZoom:<br>\\n<button type=\\\"button\\\" (click)=\\\"zoom(1.2)\\\">+</button>\\n<button type=\\\"button\\\" (click)=\\\"zoom(1/1.2)\\\">-</button><br><br>\\nBrush size:<br>\\n<input type=\\\"range\\\" min=\\\"1\\\" max=\\\"100\\\" value=\\\"20\\\" (change)=\\\"changePenSize($event);\\\"/><br><br>\\n\\n<button type=\\\"button\\\" (click)=\\\"blur()\\\">blur</button><br><br>\\n<button type=\\\"button\\\" (click)=\\\"renderDialog()\\\">render</button>\\n\\n<div id=\\\"dialogBack\\\" (click)=\\\"closeDialog($event)\\\" [ngClass]=\\\"{'hidden':!renderLayerVisible}\\\">\\n  <div id=\\\"newLayerDialog\\\" (click)=\\\"$event.stopPropagation()\\\">\\n    <h1>Render video</h1>\\n    <input type=\\\"number\\\" id=\\\"renderTime\\\"/> seconds<br><br>\\n    <button type=\\\"button\\\" (click)=\\\"render()\\\">render</button>\\n    <div id=\\\"outputElement\\\">\\n\\n    </div>\\n  </div>\\n</div>\\n\"","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","export default \".mainFlex {\\n  position: absolute;\\n  display: flex;\\n  width: 100%;\\n  top: 0px;\\n  bottom: 0px;\\n}\\n\\n.centerPanel {\\n  display: flex;\\n  width: 200px;\\n  flex-direction: column;\\n}\\n\\n.flexGrow {\\n  flex-grow: 1;\\n  flex-basis: 0;\\n  overflow: auto;\\n}\\n\\n.roundPanel {\\n  margin: 1rem;\\n  padding: 1rem;\\n  background: lightgray;\\n  border: 1px solid gray;\\n  border-radius: 0.2rem;\\n}\\n\\n.rectPanel {\\n  margin: 1rem;\\n  padding: 1rem;\\n  background: lightgray;\\n  border: 1px solid gray;\\n}\\n\\n.hidden {\\n  display: none;\\n}\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvYXBwLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxrQkFBa0I7RUFDbEIsYUFBYTtFQUNiLFdBQVc7RUFDWCxRQUFRO0VBQ1IsV0FBVztBQUNiOztBQUVBO0VBQ0UsYUFBYTtFQUNiLFlBQVk7RUFDWixzQkFBc0I7QUFDeEI7O0FBRUE7RUFDRSxZQUFZO0VBQ1osYUFBYTtFQUNiLGNBQWM7QUFDaEI7O0FBRUE7RUFDRSxZQUFZO0VBQ1osYUFBYTtFQUNiLHFCQUFxQjtFQUNyQixzQkFBc0I7RUFDdEIscUJBQXFCO0FBQ3ZCOztBQUVBO0VBQ0UsWUFBWTtFQUNaLGFBQWE7RUFDYixxQkFBcUI7RUFDckIsc0JBQXNCO0FBQ3hCOztBQUVBO0VBQ0UsYUFBYTtBQUNmIiwiZmlsZSI6InNyYy9hcHAvYXBwLmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIubWFpbkZsZXgge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIHdpZHRoOiAxMDAlO1xuICB0b3A6IDBweDtcbiAgYm90dG9tOiAwcHg7XG59XG5cbi5jZW50ZXJQYW5lbCB7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIHdpZHRoOiAyMDBweDtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbn1cblxuLmZsZXhHcm93IHtcbiAgZmxleC1ncm93OiAxO1xuICBmbGV4LWJhc2lzOiAwO1xuICBvdmVyZmxvdzogYXV0bztcbn1cblxuLnJvdW5kUGFuZWwge1xuICBtYXJnaW46IDFyZW07XG4gIHBhZGRpbmc6IDFyZW07XG4gIGJhY2tncm91bmQ6IGxpZ2h0Z3JheTtcbiAgYm9yZGVyOiAxcHggc29saWQgZ3JheTtcbiAgYm9yZGVyLXJhZGl1czogMC4ycmVtO1xufVxuXG4ucmVjdFBhbmVsIHtcbiAgbWFyZ2luOiAxcmVtO1xuICBwYWRkaW5nOiAxcmVtO1xuICBiYWNrZ3JvdW5kOiBsaWdodGdyYXk7XG4gIGJvcmRlcjogMXB4IHNvbGlkIGdyYXk7XG59XG5cbi5oaWRkZW4ge1xuICBkaXNwbGF5OiBub25lO1xufVxuIl19 */\"","import {Component, ElementRef, ViewChild} from '@angular/core';\nimport {ProjectDataService} from './services/project-data.service';\nimport {LayerType} from './services/layer';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.css']\n})\nexport class AppComponent {\n  title = 'sedart';\n\n\n  @ViewChild('previewPanel', {static: false, read: ElementRef}) previewPanel: ElementRef;\n  @ViewChild('editorPanel', {static: false, read: ElementRef}) editorPanel: ElementRef;\n  LayerType = LayerType;\n\n  constructor(private pds: ProjectDataService) {\n  }\n\n  scroll(e) {\n    this.pds.curScrollLeft = e.srcElement.scrollLeft;\n    this.pds.curScrollTop = e.srcElement.scrollTop;\n\n    setTimeout(() => {\n      if (this.editorPanel.nativeElement.scrollTop !== this.pds.curScrollTop || this.editorPanel.nativeElement.scrollLeft !== this.pds.curScrollLeft) {\n        this.editorPanel.nativeElement.scrollTop = this.pds.curScrollTop;\n        this.editorPanel.nativeElement.scrollLeft = this.pds.curScrollLeft;\n      } else {\n        this.previewPanel.nativeElement.scrollTop = this.pds.curScrollTop;\n        this.previewPanel.nativeElement.scrollLeft = this.pds.curScrollLeft;\n      }\n    }, 0);\n  }\n}\n","import { BrowserModule } from '@angular/platform-browser';\nimport { NgModule } from '@angular/core';\n\nimport { AppComponent } from './app.component';\nimport { LayerPanelComponent } from './layer-panel/layer-panel.component';\nimport { EditorPanelComponent } from './editor-panel/editor-panel.component';\nimport { PreviewPanelComponent } from './preview-panel/preview-panel.component';\nimport { ToolPanelComponent } from './tool-panel/tool-panel.component';\nimport { DirectionColorPickerComponent } from './tool-panel/direction-color-picker/direction-color-picker.component';\nimport { LayerSelectComponent } from './layer-panel/layer-select/layer-select.component';\nimport { ParticleEditorComponent } from './particle-editor/particle-editor.component';\n\n@NgModule({\n  declarations: [\n    AppComponent,\n    LayerPanelComponent,\n    EditorPanelComponent,\n    PreviewPanelComponent,\n    ToolPanelComponent,\n    DirectionColorPickerComponent,\n    LayerSelectComponent,\n    ParticleEditorComponent\n  ],\n  imports: [\n    BrowserModule\n  ],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule { }\n","export default \"#previewCanvas {\\n  transition: 0.3s ease-in-out;\\n}\\n\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvZWRpdG9yLXBhbmVsL2VkaXRvci1wYW5lbC5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsNEJBQTRCO0FBQzlCIiwiZmlsZSI6InNyYy9hcHAvZWRpdG9yLXBhbmVsL2VkaXRvci1wYW5lbC5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiI3ByZXZpZXdDYW52YXMge1xuICB0cmFuc2l0aW9uOiAwLjNzIGVhc2UtaW4tb3V0O1xufVxuXG4iXX0= */\"","import {AfterViewInit, Component, ElementRef, EventEmitter, OnInit, Output, ViewChild} from '@angular/core';\nimport {ProjectDataService} from '../services/project-data.service';\nimport {LayerType} from '../services/layer';\nimport {MorphLayer} from '../services/morphlayer';\n\n@Component({\n  selector: 'app-editor-panel',\n  templateUrl: './editor-panel.component.html',\n  styleUrls: ['./editor-panel.component.css']\n})\nexport class EditorPanelComponent implements OnInit, AfterViewInit {\n  @ViewChild('previewCanvas', {static: false, read: ElementRef}) previewCanvas: ElementRef;\n  @ViewChild('flowmapCanvas', {static: false, read: ElementRef}) flowmapCanvas: ElementRef;\n  previewCtx: CanvasRenderingContext2D;\n  flowmapCtx: CanvasRenderingContext2D;\n  paint = false;\n  mouseover = false;\n  radius = 20;\n  image: HTMLImageElement;\n  origImage: HTMLImageElement;\n  current = {x: 0, y: 0, zoom: 1};\n  curZoom = 1;\n\n  @Output() scrollSync: EventEmitter<any> = new EventEmitter<any>();\n\n  constructor(private pds: ProjectDataService) {\n  }\n\n  ngOnInit() {\n  }\n\n  updateImage() {\n    if (!this.pds.curLayer || this.pds.curLayer.type !== LayerType.MorphLayer) {\n      return;\n    }\n    const image = this.pds.editorImage;\n\n    this.previewCanvas.nativeElement.width = image.width;\n    this.previewCanvas.nativeElement.height = image.height;\n\n    this.flowmapCanvas.nativeElement.width = image.width;\n    this.flowmapCanvas.nativeElement.height = image.height;\n\n    this.previewCtx = this.previewCanvas.nativeElement.getContext('2d');\n    this.flowmapCtx = this.flowmapCanvas.nativeElement.getContext('2d');\n\n    this.flowmapCtx.fillStyle = '#808080';\n    this.flowmapCtx.fillRect(0, 0, this.previewCanvas.nativeElement.width, this.previewCanvas.nativeElement.height);\n    if (this.pds.editorImage) {\n      this.flowmapCtx.drawImage(this.pds.editorImage, 0, 0); // Or at whatever offset you like\n      this.previewCtx.drawImage(this.pds.editorImage, 0, 0); // Or at whatever offset you like\n    }\n\n    this.updatePreviewImage(-10, -10);\n  }\n\n  ngAfterViewInit(): void {\n    this.updateImage();\n    this.pds.layerSelectionChange.subscribe(() => this.updateImage());\n    this.pds.blurEmitter.subscribe(n => this.blur(n));\n    this.previewCanvas.nativeElement.addEventListener('mousemove', (ev) => this.mousemove(ev));\n    this.previewCanvas.nativeElement.addEventListener('mousedown', (ev) => this.mousedown(ev));\n    this.previewCanvas.nativeElement.addEventListener('mouseup', (ev) => this.mouseup(ev));\n    this.previewCanvas.nativeElement.addEventListener('mouseenter', (ev) => this.mouseover = true);\n    this.previewCanvas.nativeElement.addEventListener('mouseleave', (ev) => {\n      this.mouseover = false;\n      this.updatePreviewImage(-10, -10);\n    });\n\n    this.windowChanged();\n    this.pds.windowChanged.subscribe((e) => this.windowChanged());\n\n    this.updatePreviewImage(-20, -20);\n  }\n\n  mousemove(e) {\n    if (e.button === 0) {\n      const mouseX = (e.offsetX != null) ? e.offsetX : e.originalEvent.layerX;\n      const mouseY = (e.offsetY != null) ? e.offsetY : e.originalEvent.layerY;\n      this.drawAtPos(mouseX, mouseY);\n      this.updatePreviewImage(mouseX, mouseY);\n    }\n\n  }\n\n  mousedown(e) {\n    if (e.button === 0) {\n      this.paint = true;\n      const rect = this.previewCanvas.nativeElement.getBoundingClientRect();\n      const mouseX = (e.offsetX != null) ? e.offsetX : e.originalEvent.layerX;\n      const mouseY = (e.offsetY != null) ? e.offsetY : e.originalEvent.layerY;\n      this.drawAtPos(mouseX, mouseY);\n      this.updatePreviewImage(mouseX, mouseY);\n    }\n  }\n\n  mouseup(e) {\n    if (e.button === 0) {\n      this.paint = false;\n      this.pds.setFlowMap(this.flowmapCanvas.nativeElement);\n    }\n  }\n\n  blur(r) {\n    const c = this.flowmapCanvas.nativeElement;\n    const ctx = this.flowmapCtx;\n    ctx.filter = 'blur(' + r + 'px)';\n    ctx.drawImage(c, 0, 0);\n    ctx.filter = 'none';\n\n    this.pds.setFlowMap(this.flowmapCanvas.nativeElement);\n    this.updatePreviewImage(-20, -20);\n\n\n  }\n\n  windowChanged() {\n    this.curZoom = this.pds.curZoom;\n    this.previewCanvas.nativeElement.style.transform = 'scale(' + this.curZoom + ')';\n    this.previewCanvas.nativeElement.style.transformOrigin = 'top left';\n  }\n\n  private updatePreviewImage(mouseX: number, mouseY: number) {\n    if (!this.pds.curLayer) {\n      return;\n    }\n    this.previewCtx.globalAlpha = 1;\n    this.previewCtx.drawImage(this.flowmapCanvas.nativeElement, 0, 0);\n\n    if (this.pds.curLayer.type === LayerType.MorphLayer && (this.pds.curLayer as MorphLayer).getImage()) {\n      this.previewCtx.globalAlpha = 0.2;\n      this.previewCtx.drawImage((this.pds.curLayer as MorphLayer).getImage(), 0, 0);\n    }\n    this.previewCtx.globalAlpha = 1;\n\n    if (this.mouseover) {\n      this.previewCtx.beginPath();\n      this.previewCtx.arc(mouseX, mouseY, this.pds.drawSize, 0, 2 * Math.PI);\n      this.previewCtx.strokeStyle = this.pds.curColor;\n      this.previewCtx.stroke();\n    }\n  }\n\n  private drawAtPos(mouseX: number, mouseY: number) {\n    if (this.paint) {\n      for (let r = this.pds.drawSize; r > 0; r--) {\n        this.flowmapCtx.globalAlpha = (this.pds.drawSize - r) / this.pds.drawSize;\n        this.flowmapCtx.beginPath();\n        this.flowmapCtx.arc(mouseX, mouseY, r, 0, 2 * Math.PI);\n        this.flowmapCtx.fillStyle = this.pds.curColor;\n        this.flowmapCtx.fill();\n      }\n      this.flowmapCtx.globalAlpha = 1;\n    }\n  }\n\n}\n","export default \".flexContainer {\\n  display: flex;\\n  height: 100%;\\n  width: 100%;\\n  flex-direction: column;\\n}\\n\\n.toolbar {\\n  margin-top: 1rem;\\n}\\n\\n.layers {\\n  flex-grow: 1;\\n  display: flex;\\n  flex-direction: column-reverse;\\n  overflow: auto;\\n  padding: 0.2rem;\\n  background: rgba(255,255,255, 0.2);\\n}\\n\\n#dialogBack.hidden {\\n  display: none;\\n}\\n\\n#dialogBack {\\n  position: fixed;\\n  left: 0;\\n  top: 0;\\n  width: 100%;\\n  height: 100%;\\n  min-width: 300px;\\n  min-height: 200px;\\n  background: rgba(0,0,0,0.2);\\n  z-index: 1000;\\n  display: grid;\\n}\\n\\n#newLayerDialog {\\n  width: 300px;\\n  margin-right: auto;\\n  padding: 1rem;\\n  background-color: white;\\n}\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvbGF5ZXItcGFuZWwvbGF5ZXItcGFuZWwuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGFBQWE7RUFDYixZQUFZO0VBQ1osV0FBVztFQUNYLHNCQUFzQjtBQUN4Qjs7QUFFQTtFQUNFLGdCQUFnQjtBQUNsQjs7QUFFQTtFQUNFLFlBQVk7RUFDWixhQUFhO0VBQ2IsOEJBQThCO0VBQzlCLGNBQWM7RUFDZCxlQUFlO0VBQ2Ysa0NBQWtDO0FBQ3BDOztBQUVBO0VBQ0UsYUFBYTtBQUNmOztBQUVBO0VBQ0UsZUFBZTtFQUNmLE9BQU87RUFDUCxNQUFNO0VBQ04sV0FBVztFQUNYLFlBQVk7RUFDWixnQkFBZ0I7RUFDaEIsaUJBQWlCO0VBQ2pCLDJCQUEyQjtFQUMzQixhQUFhO0VBQ2IsYUFBYTtBQUNmOztBQUVBO0VBQ0UsWUFBWTtFQUNaLGtCQUFrQjtFQUNsQixhQUFhO0VBQ2IsdUJBQXVCO0FBQ3pCIiwiZmlsZSI6InNyYy9hcHAvbGF5ZXItcGFuZWwvbGF5ZXItcGFuZWwuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIi5mbGV4Q29udGFpbmVyIHtcbiAgZGlzcGxheTogZmxleDtcbiAgaGVpZ2h0OiAxMDAlO1xuICB3aWR0aDogMTAwJTtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbn1cblxuLnRvb2xiYXIge1xuICBtYXJnaW4tdG9wOiAxcmVtO1xufVxuXG4ubGF5ZXJzIHtcbiAgZmxleC1ncm93OiAxO1xuICBkaXNwbGF5OiBmbGV4O1xuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uLXJldmVyc2U7XG4gIG92ZXJmbG93OiBhdXRvO1xuICBwYWRkaW5nOiAwLjJyZW07XG4gIGJhY2tncm91bmQ6IHJnYmEoMjU1LDI1NSwyNTUsIDAuMik7XG59XG5cbiNkaWFsb2dCYWNrLmhpZGRlbiB7XG4gIGRpc3BsYXk6IG5vbmU7XG59XG5cbiNkaWFsb2dCYWNrIHtcbiAgcG9zaXRpb246IGZpeGVkO1xuICBsZWZ0OiAwO1xuICB0b3A6IDA7XG4gIHdpZHRoOiAxMDAlO1xuICBoZWlnaHQ6IDEwMCU7XG4gIG1pbi13aWR0aDogMzAwcHg7XG4gIG1pbi1oZWlnaHQ6IDIwMHB4O1xuICBiYWNrZ3JvdW5kOiByZ2JhKDAsMCwwLDAuMik7XG4gIHotaW5kZXg6IDEwMDA7XG4gIGRpc3BsYXk6IGdyaWQ7XG59XG5cbiNuZXdMYXllckRpYWxvZyB7XG4gIHdpZHRoOiAzMDBweDtcbiAgbWFyZ2luLXJpZ2h0OiBhdXRvO1xuICBwYWRkaW5nOiAxcmVtO1xuICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTtcbn1cbiJdfQ== */\"","import {AfterViewInit, Component, ElementRef, OnInit, ViewChild} from '@angular/core';\nimport {ProjectDataService} from '../services/project-data.service';\nimport {MorphLayer} from '../services/morphlayer';\nimport {ParticleLayer} from '../services/particlelayer';\n\n@Component({\n  selector: 'app-layer-panel',\n  templateUrl: './layer-panel.component.html',\n  styleUrls: ['./layer-panel.component.css']\n})\nexport class LayerPanelComponent implements OnInit, AfterViewInit {\n\n  @ViewChild('layerNameInput', {static: false, read: ElementRef}) layerNameInput: ElementRef;\n  @ViewChild('imageLoader', {static: false, read: ElementRef}) imageLoader: ElementRef;\n  @ViewChild('imageCanvas', {static: false, read: ElementRef}) canvas: ElementRef;\n  ctx: CanvasRenderingContext2D;\n  newLayerVisible = false;\n\n  constructor(private pds: ProjectDataService) {\n  }\n\n  ngOnInit() {\n  }\n\n  ngAfterViewInit() {\n    this.imageLoader.nativeElement.addEventListener('change', (event) => {\n      this.handleImage(event);\n    }, false);\n    this.ctx = this.canvas.nativeElement.getContext('2d');\n  }\n\n  handleImage(e) {\n    const selfRef = this;\n    const reader = new FileReader();\n    reader.onload = (event: any) => {\n      const img = new Image();\n      img.onload = () => {\n        selfRef.canvas.nativeElement.style.width = '200px';\n        selfRef.canvas.nativeElement.width = img.width;\n        selfRef.canvas.nativeElement.height = img.height;\n        selfRef.ctx.drawImage(img, 0, 0);\n        //selfRef.dataService.setImage(img);\n\n        const tcanvas = document.createElement('canvas');\n        tcanvas.width = img.width;\n        tcanvas.height = img.height;\n        const tctx = tcanvas.getContext('2d');\n        tctx.fillStyle = '#808080';\n        tctx.fillRect(0, 0, tcanvas.width, tcanvas.height);\n\n        //selfRef.dataService.setFlowMap(tcanvas.toDataURL('image/png'));\n\n      };\n      img.src = event.target.result;\n    };\n    reader.readAsDataURL(e.target.files[0]);\n  }\n\n  createLayer() {\n    const tc = document.createElement('canvas');\n    tc.width = (this.canvas as any).nativeElement.width;\n    tc.height = (this.canvas as any).nativeElement.height;\n    /*tc.width = 1024;\n    tc.height = 1024;*/\n    const tctx = tc.getContext('2d');\n    tctx.drawImage(this.canvas.nativeElement, 0, 0, this.canvas.nativeElement.width, this.canvas.nativeElement.height, 0, 0, tc.width, tc.height);\n\n    this.pds.addLayer(new MorphLayer(this.layerNameInput.nativeElement.value, (document.getElementById('morphType') as any).value, tc));\n    this.newLayerVisible = false;\n  }\n\n  createParticleLayer() {\n    this.pds.addLayer(new ParticleLayer(this.layerNameInput.nativeElement.value, 512, 512));\n    this.newLayerVisible = false;\n  }\n\n  selectLayerType(select: string) {\n    if (select === 'morph') {\n      document.getElementById('morphInput').style.display = 'block';\n      document.getElementById('particleInput').style.display = 'none';\n    } else {\n      document.getElementById('morphInput').style.display = 'none';\n      document.getElementById('particleInput').style.display = 'block';\n    }\n  }\n}\n","export default \".host {\\n  border: 1px solid gray;\\n  padding: 0.2rem;\\n  display: block;\\n  cursor: pointer;\\n  background-color: white;\\n}\\n\\n.selected{\\n  background-color: aliceblue;\\n}\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvbGF5ZXItcGFuZWwvbGF5ZXItc2VsZWN0L2xheWVyLXNlbGVjdC5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0Usc0JBQXNCO0VBQ3RCLGVBQWU7RUFDZixjQUFjO0VBQ2QsZUFBZTtFQUNmLHVCQUF1QjtBQUN6Qjs7QUFFQTtFQUNFLDJCQUEyQjtBQUM3QiIsImZpbGUiOiJzcmMvYXBwL2xheWVyLXBhbmVsL2xheWVyLXNlbGVjdC9sYXllci1zZWxlY3QuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIi5ob3N0IHtcbiAgYm9yZGVyOiAxcHggc29saWQgZ3JheTtcbiAgcGFkZGluZzogMC4ycmVtO1xuICBkaXNwbGF5OiBibG9jaztcbiAgY3Vyc29yOiBwb2ludGVyO1xuICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTtcbn1cblxuLnNlbGVjdGVke1xuICBiYWNrZ3JvdW5kLWNvbG9yOiBhbGljZWJsdWU7XG59XG4iXX0= */\"","import {Component, Input, OnInit} from '@angular/core';\nimport {Layer} from '../../services/layer';\nimport {ProjectDataService} from '../../services/project-data.service';\n\n@Component({\n  selector: 'app-layer-select',\n  templateUrl: './layer-select.component.html',\n  styleUrls: ['./layer-select.component.css']\n})\nexport class LayerSelectComponent implements OnInit {\n\n  @Input() layer: Layer;\n\n  constructor(private pds: ProjectDataService) { }\n\n  ngOnInit() {\n  }\n\n  selectLayer() {\n    this.pds.selectLayer(this.layer);\n  }\n}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3BhcnRpY2xlLWVkaXRvci9wYXJ0aWNsZS1lZGl0b3IuY29tcG9uZW50LmNzcyJ9 */\"","import {Component, OnInit} from '@angular/core';\nimport {ProjectDataService} from '../services/project-data.service';\nimport {ParticleLayer} from '../services/particlelayer';\nimport {Emitter} from '../services/particles/emitter';\n\n@Component({\n  selector: 'app-particle-editor',\n  templateUrl: './particle-editor.component.html',\n  styleUrls: ['./particle-editor.component.css']\n})\nexport class ParticleEditorComponent implements OnInit {\n\n  constructor(public pds: ProjectDataService) {\n  }\n\n  ngOnInit() {\n  }\n\n  getParticleLayer() {\n    return this.pds.curLayer ? (this.pds.curLayer as ParticleLayer) : [];\n  }\n\n  updateEmitter(emitter: Emitter, key: string, event: Event) {\n    emitter[key] = parseFloat((event.target as any).value);\n  }\n\n  updateImage(emitter: Emitter, key: string, e: any) {\n    const selfRef = this;\n    const reader = new FileReader();\n    reader.onload = (event: any) => {\n      const img = new Image();\n      img.onload = () => {\n        const tcanvas = document.createElement('canvas');\n        tcanvas.width = img.width;\n        tcanvas.height = img.height;\n        const tctx = tcanvas.getContext('2d');\n        tctx.drawImage(img, 0, 0);\n\n        emitter[key] = tcanvas;\n\n      };\n      img.src = event.target.result;\n    };\n    reader.readAsDataURL(e.target.files[0]);\n  }\n\n}\n","export default \"#CanvasFinal {\\n  transition: 0.3s ease-in-out;\\n}\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcHJldmlldy1wYW5lbC9wcmV2aWV3LXBhbmVsLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSw0QkFBNEI7QUFDOUIiLCJmaWxlIjoic3JjL2FwcC9wcmV2aWV3LXBhbmVsL3ByZXZpZXctcGFuZWwuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIiNDYW52YXNGaW5hbCB7XG4gIHRyYW5zaXRpb246IDAuM3MgZWFzZS1pbi1vdXQ7XG59XG4iXX0= */\"","import {AfterViewInit, Component, ElementRef, Input, OnInit, SimpleChanges, ViewChild} from '@angular/core';\nimport * as THREE from 'three-full';\nimport {ProjectDataService} from '../services/project-data.service';\nimport {ThreeContext} from './renderer';\n\n@Component({\n  selector: 'app-preview-panel',\n  templateUrl: './preview-panel.component.html',\n  styleUrls: ['./preview-panel.component.css']\n})\nexport class PreviewPanelComponent implements OnInit, AfterViewInit {\n\n  @Input() scrollSync: any;\n\n  @ViewChild('CanvasFinal', {static: false, read: ElementRef}) canvas: ElementRef;\n  private contextCanvasFinal: ThreeContext;\n\n  constructor(private pds: ProjectDataService) {\n  }\n\n  windowChanged() {\n    const curZoom = this.pds.curZoom;\n    this.canvas.nativeElement.style.transform = 'scale(' + curZoom + ')';\n    this.canvas.nativeElement.style.transformOrigin = 'top left';\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n\n  }\n\n  ngOnInit() {\n  }\n\n  ngAfterViewInit() {\n    this.windowChanged();\n    this.pds.windowChanged.subscribe((e) => this.windowChanged());\n    this.init();\n    this.pds.layerContentChange.subscribe(() => this.init());\n    this.pds.layerSelectionChange.subscribe(() => this.init());\n  }\n\n  init() {\n    if (!this.pds.curLayer) {\n      return;\n    }\n    const image = this.pds.editorImage;\n    const canvas = document.getElementById('CanvasFinal');\n    (canvas as any).width = this.pds.width;\n    (canvas as any).height = this.pds.height;\n\n    (canvas as any).style.width = this.pds.width;\n    (canvas as any).style.height = this.pds.height;\n\n    if (this.contextCanvasFinal) {\n      this.contextCanvasFinal.running = false;\n    }\n\n    const selfRef = this;\n\n    this.contextCanvasFinal = new ThreeContext('CanvasFinal', (threeContext) => {\n      threeContext.uniforms = {\n        flowSpeed: {type: 'f', value: 0.02},\n        cycleTime: {type: 'f', value: 10},\n      };\n      // waveMapFrag\n      threeContext.initFullScreenCanvas(selfRef.pds.layers);\n    }, null);\n    this.contextCanvasFinal.render(selfRef.pds.layers);\n    this.contextCanvasFinal.renderFrame.subscribe( () => selfRef.pds.renderedFrameEmitter.emit());\n  }\n\n}\n","import * as THREE from 'three-full';\nimport {Layer} from '../services/layer';\nimport {EventEmitter} from '@angular/core';\n\nexport class ThreeContext {\n\n  canvas: HTMLElement;\n  renderer: THREE.WebGLRenderer;\n  uniforms: any;\n  scene: THREE.Scene;\n  camera: THREE.PerspectiveCamera;\n  clock: THREE.Clock;\n  renderFunction: any;\n  size: [number, number];\n  timeDelta: number;\n  running = true;\n  uniformList = [];\n\n  renderFrame = new EventEmitter();\n  time = 0;\n\n\n  constructor(canvasName, initFunction, renderFunction) {\n    this.canvas = document.getElementById(canvasName);\n    this.renderer = new THREE.WebGLRenderer({canvas: this.canvas, antialiasing: false, alpha: true});\n    this.uniforms = {};\n    this.scene = new THREE.Scene();\n    this.camera = null;\n    this.clock = new THREE.Clock(true);\n    this.renderFunction = renderFunction;\n\n    this.renderer.setPixelRatio(window.devicePixelRatio);\n\n    this.size = [(this.canvas as any).width, (this.canvas as any).height];\n    this.renderer.setSize(this.size[0], this.size[1]);\n\n    if (initFunction !== 'undefined') {\n      initFunction(this);\n    } else {\n      // Use a default camera\n      this.camera = new THREE.PerspectiveCamera(45, 1, 0.1, 1000);\n    }\n  }\n\n  initFullScreenCanvas(layers) {\n    const useVertColors = undefined;\n    const vertShaderName = 'passthroughVert';\n    const fragShaderName = 'flowMapFrag';\n    const halfSize = [this.size[0] / 2, this.size[1] / 2];\n\n    // Setup camera\n    this.camera = new THREE.OrthographicCamera(-halfSize[0], halfSize[0], halfSize[1], -halfSize[1], -10, 1000);\n    this.camera.position.z = 1;\n\n    const defaultUniforms = {\n      time: {type: 'f', value: 0.0},\n      timeDelta: {type: 'f', value: 0.0},\n    };\n    this.uniforms = extend_object(defaultUniforms, this.uniforms || {});\n    this.scene = this.createFullScreenQuadScene(layers);\n  }\n\n  updateDefaultUniforms(uniforms) {\n    if (uniforms.timeDelta != null) {\n      uniforms.timeDelta.value = this.timeDelta;\n    }\n    if (uniforms.time != null) {\n      uniforms.time.value = this.time;\n    }\n  }\n\n  render(layers: Layer[]) {\n    if (!this.camera) {\n      return;\n    }\n    const self = this;\n    if (this.running) {\n      requestAnimationFrame(() => {\n        self.render(layers);\n        self.renderFrame.emit();\n        this.time += 1 / 60;\n      });\n    }\n\n    for (const layer of layers) {\n      layer.timeStep();\n    }\n    this.timeDelta = this.time;\n    this.updateDefaultUniforms(this.uniforms);\n    this.uniformList.forEach((uniform) => {\n      this.updateDefaultUniforms(uniform);\n    });\n    this.renderer.setClearColor(0xff0000, 0);\n    this.renderer.clear();\n\n    if (this.renderFunction !== 'undefined' && this.renderFunction != null) {\n      this.renderFunction(this);\n    }\n\n    this.renderer.render(this.scene, this.camera);\n  }\n\n  createFullScreenQuadScene(layers) {\n    const scene = new THREE.Scene();\n    this.uniformList = [];\n    layers.forEach((layer, i) => {\n      const tuniforms = layer.addToScene(scene, i);\n\n      this.uniformList.push(tuniforms);\n    });\n    return scene;\n  }\n\n}\n\nfunction extend_object(destination, source) {\n  for (const property in source) {\n    if (source.hasOwnProperty(property)) {\n      destination[property] = source[property];\n    }\n  }\n  return destination;\n}\n\nfunction createMaterial(vertShaderName, fragShaderName, uniforms, useVertColors) {\n  const vShader = document.getElementById(vertShaderName);\n  if (vShader == null) {\n    console.error('Couldn\\'t find vert shader: ' + vertShaderName);\n  }\n\n  const fShader = document.getElementById(fragShaderName);\n  if (fShader == null) {\n    console.error('Couldn\\'t find frag shader: ' + fragShaderName);\n  }\n\n  return new THREE.ShaderMaterial({\n    uniforms: uniforms || {},\n    vertexShader: (vShader as any).text,\n    fragmentShader: (fShader as any).text,\n    vertexColors: useVertColors ? THREE.VertexColors : THREE.NoColors,\n    transparent: true,\n  });\n}\n\nexport function createFullScreenQuad(vertShaderName, fragShaderName, uniforms, useVertColors, z) {\n  const shaderMaterial = createMaterial(vertShaderName, fragShaderName, uniforms, useVertColors);\n  const planeGeo = new THREE.PlaneGeometry(2, 2, 1, 1);\n  planeGeo.translate(0, 0, -z / 10.0);\n  const mesh = new THREE.Mesh(planeGeo, shaderMaterial);\n  mesh.name = 'FullScreenQuad';\n  return mesh;\n}\n\n\nfunction setVertColors(mesh, color) {\n  for (let i = 0; i < mesh.faces.length; i++) {\n    const face = mesh.faces[i];\n    face.vertexColors = [color, color, color];\n  }\n}\n","export enum LayerType {\n  MorphLayer = 1,\n  ParticleLayer\n}\n\nexport interface Layer {\n  type: LayerType;\n  addToScene(scene, index): any;\n  timeStep();\n  saveState();\n  restoreState(state);\n}\n","import {createDefaultImage} from './utils';\nimport * as THREE from 'three-full';\nimport {createFullScreenQuad} from '../preview-panel/renderer';\nimport {Layer, LayerType} from './layer';\n\nexport class MorphLayer implements Layer {\n  public type = LayerType.MorphLayer;\n\n  private flowmap: HTMLCanvasElement;\n  public image: HTMLCanvasElement;\n\n  public flowmapTexture: THREE.CanvasTexture;\n  public imageTexture: THREE.CanvasTexture;\n\n  constructor(public name: string, public morphType: string, inputImage?) {\n    this.type = LayerType.MorphLayer;\n    if (!inputImage) {\n      // create dummy data\n      this.setFlowmap(createDefaultImage(512, 512));\n      this.setImage(createDefaultImage(512, 512));\n    } else {\n      this.setFlowmap(createDefaultImage(inputImage.width, inputImage.height));\n      this.setImage(inputImage);\n    }\n\n  }\n\n  setFlowmap(newFlowmap) {\n    this.flowmap = newFlowmap;\n    this.flowmapTexture = new THREE.CanvasTexture(this.flowmap);\n    this.flowmapTexture.flipY = false;\n    this.flowmapTexture.magFilter = THREE.NearestFilter;\n    this.flowmapTexture.minFilter = THREE.NearestFilter;\n  }\n\n  getFlowmap() {\n    return this.flowmap;\n  }\n\n  getFlowmapTexture() {\n    return this.flowmapTexture;\n  }\n\n  setImage(newImage) {\n    this.image = newImage;\n\n    const tc = document.createElement('canvas');\n    /*tc.width = (newFlowmap as any).nativeElement.width;\n    tc.height = (newFlowmap as any).nativeElement.height;*/\n    tc.width = 1024;\n    tc.height = 1024;\n    const tctx = tc.getContext('2d');\n    tctx.drawImage(newImage, 0, 0, newImage.width, newImage.height, 0, 0, 1024, 1024);\n\n\n    this.imageTexture = new THREE.CanvasTexture(tc);\n    // this.imageTexture.magFilter = THREE.NearestFilter;\n    // this.imageTexture.minFilter = THREE.NearestFilter;\n    this.imageTexture.flipY = false;\n  }\n\n  addToScene(scene, index) {\n    const tuniforms = {\n      texture: {type: 't', value: this.getImageTexture()},\n      flowMap: {type: 't', value: this.getFlowmapTexture()},\n      flowSpeed: {type: 'f', value: 0.1},\n      cycleTime: {type: 'f', value: 5},\n      time: {type: 'f', value: 0.0},\n      timeDelta: {type: 'f', value: 0.0},\n    };\n\n    const plane = createFullScreenQuad('passthroughVert', this.morphType, tuniforms, null, index);\n    scene.add(plane);\n    return tuniforms;\n  }\n\n  getImage() {\n    return this.image;\n  }\n\n  getImageTexture() {\n    return this.imageTexture;\n  }\n\n  timeStep() {\n  }\n\n  saveState() {\n    return {\n      type: this.type,\n      name: this.name,\n      flowMap: this.getFlowmap().toDataURL('image/png'),\n      image: this.getImage().toDataURL('image/png'),\n    };\n  }\n\n  restoreState(state) {\n    \n  }\n}\n","import {createDefaultImage} from './utils';\nimport * as THREE from 'three-full';\nimport {createFullScreenQuad} from '../preview-panel/renderer';\nimport {Layer, LayerType} from './layer';\nimport {Particle, ParticleFactory} from './particles/particle';\nimport {RectangularEmitter} from './particles/emitter';\n\nexport class ParticleLayer implements Layer {\n  public type = LayerType.ParticleLayer;\n\n  private canvas: HTMLCanvasElement;\n\n  public canvasTexture: THREE.CanvasTexture;\n\n  public emitters = [new RectangularEmitter()];\n  public particles = [];\n  public deadps = [];\n  public particleFactories: ParticleFactory[] = [new ParticleFactory()];\n\n  constructor(public name: string, width, height) {\n    // create dummy data\n    this.setCanvas(createDefaultImage(width, height));\n    this.type = LayerType.ParticleLayer;\n  }\n\n  setCanvas(newCanvas) {\n    this.canvas = newCanvas;\n    this.canvasTexture = new THREE.CanvasTexture(this.canvas);\n    this.canvasTexture.flipY = false;\n    this.canvasTexture.magFilter = THREE.NearestFilter;\n    this.canvasTexture.minFilter = THREE.NearestFilter;\n  }\n\n  getCanvasTexture() {\n    return this.canvasTexture;\n  }\n\n  addToScene(scene, index) {\n    const tuniforms = {\n      texture: {type: 't', value: this.getCanvasTexture()},\n      time: {type: 'f', value: 0.0},\n      timeDelta: {type: 'f', value: 0.0},\n    };\n    const plane = createFullScreenQuad('passthroughVert', 'passthroughFrag', tuniforms, null, index);\n    scene.add(plane);\n    return tuniforms;\n  }\n\n  timeStep() {\n    const ctx = this.canvas.getContext('2d');\n    ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n\n    const scaleX = this.canvas.width / 100;\n    const scaleY = this.canvas.height / 100;\n\n    for (const p of this.particles) {\n      p.x += p.vx;\n      p.y += p.vy;\n      p.ttl -= 1;\n      if (p.ttl === 0) {\n        p.dead = true;\n        this.deadps.push(p);\n      }\n    }\n\n    for (const p of this.particles) {\n      if (p.ttl >= 0) {\n        p.draw(ctx);\n      }\n    }\n\n    for (const pf of this.particleFactories) {\n      pf.scaleX = this.canvas.width / 100;\n      pf.scaleY = this.canvas.height / 100;\n    }\n\n    for (const emitter of this.emitters) {\n      emitter.emit(this.particleFactories[0], this.particles, this.deadps);\n    }\n\n\n    this.canvasTexture.needsUpdate = true;\n  }\n\n  restoreState(state) {\n  }\n\n  saveState() {\n    return {\n      type: this.type,\n      name: this.name,\n      canvas: this.canvas.toDataURL('image/png'),\n      emitters: this.emitters.map(e => e.saveState()),\n      particleFactories: this.particleFactories.map(pf => pf.saveState())\n    };\n  }\n}\n","import {Particle, ParticleFactory} from './particle';\nimport {Field, NumberField} from './particlesystem';\n\nexport interface Emitter {\n  readableName: string;\n  emissionRate: number;\n  fields: Field[];\n\n  emit(particleFactory: ParticleFactory, particles: Particle[], deadps: Particle[]);\n}\n\nexport class RectangularEmitter implements Emitter {\n  readableName = 'Rectangular emitter';\n\n  emissionRate: number;\n  minx: number;\n  maxx: number;\n  miny: number;\n  maxy: number;\n\n  mindir: number;\n  maxdir: number;\n  minvel: number;\n  maxvel: number;\n\n  fields = [\n    new NumberField('emissionRate', 'Rate of particle emission'),\n    new NumberField('minx', 'Minimum x-pos (0-100)'),\n    new NumberField('maxx', 'Maximum x-pos (0-100)'),\n    new NumberField('miny', 'Minimum y-pos (0-100)'),\n    new NumberField('maxy', 'Maximum y-pos (0-100)'),\n    new NumberField('mindir', 'Minimum starting angle (0-360)'),\n    new NumberField('maxdir', 'Maximum starting angle (0-360)'),\n    new NumberField('minvel', 'Minimum starting velocity'),\n    new NumberField('maxvel', 'Maximum starting velocity'),\n  ];\n\n  constructor(minx = 0, miny = 0, maxx = 100, maxy = 100, mindir = 0, maxdir = 360, minvel = 1, maxvel = 2) {\n    this.minx = Math.min(minx, maxx);\n    this.maxx = Math.max(minx, maxx);\n    this.miny = Math.min(miny, maxy);\n    this.maxy = Math.max(miny, maxy);\n    this.mindir = Math.min(mindir, maxdir);\n    this.maxdir = Math.max(mindir, maxdir);\n    this.minvel = Math.min(minvel, maxvel);\n    this.maxvel = Math.max(minvel, maxvel);\n    this.emissionRate = 1;\n  }\n\n  emit(particleFactory: ParticleFactory, particles: Particle[], deadps: Particle[]): void {\n    const res = [];\n    for (let i = this.emissionRate; i > 0; i--) {\n      if (i > 1 || Math.random() < i) {\n\n        const angle = this.mindir + Math.random() * (this.maxdir - this.mindir);\n        const vel = this.minvel + Math.random() * (this.maxvel - this.minvel);\n\n        const xpos = this.minx + Math.random() * (this.maxx - this.minx);\n        const ypos = this.miny + Math.random() * (this.maxy - this.miny);\n        const xvel = Math.cos(angle / 180 * Math.PI) * vel;\n        const yvel = Math.sin(angle / 180 * Math.PI) * vel;\n\n        particleFactory.create(xpos, ypos, xvel, yvel, particles, deadps);\n      }\n    }\n  }\n\n\n  saveState() {\n    const res = {};\n    for (const field of this.fields) {\n      res[field.key] = this[field.key];\n    }\n    return res;\n  }\n\n  restoreState(state) {\n    for (const key in state) {\n      this[key] = state[key];\n    }\n  }\n}\n","import {ImageField, NumberField} from './particlesystem';\n\nexport class Particle {\n\n  dead: boolean;\n  ttl: number;\n  pf: ParticleFactory;\n  x: number;\n  y: number;\n  vx: number;\n  vy: number;\n\n  constructor() {\n    this.dead = true;\n    this.x = 0;\n    this.y = 0;\n    this.vx = 0;\n    this.vy = 0;\n    this.ttl = 0;\n  }\n\n  draw(ctx: CanvasRenderingContext2D) {\n    ctx.resetTransform();\n    ctx.globalAlpha = this.pf.getAlpha(this.ttl);\n    ctx.beginPath();\n    if (this.pf.image) {\n      ctx.translate(this.x, this.y);\n      ctx.scale(this.pf.getSize(this.ttl) * this.pf.scaleX / this.pf.image.width, this.pf.getSize(this.ttl) * this.pf.scaleY / this.pf.image.height);\n      ctx.drawImage(this.pf.image, -this.pf.image.width / 2, -this.pf.image.width / 2);\n    } else {\n      ctx.arc(this.x, this.y, 5, 0, 2 * Math.PI);\n    }\n    ctx.stroke();\n    ctx.resetTransform();\n  }\n}\n\nexport class ParticleFactory {\n  alpha1 = 0;\n  alpha2 = 1;\n  alpha3 = 0;\n  acc1 = 0;\n  acc2 = 0;\n  acc3 = 0;\n  size1 = 0;\n  size2 = 5;\n  size3 = 0;\n\n  ttl = 100;\n\n  image: HTMLCanvasElement;\n  scaleX: number;\n  scaleY: number;\n\n  fields = [\n    new NumberField('alpha1', 'Alpha beginning (0-1)'),\n    new NumberField('alpha2', 'Alpha middle (0-1)'),\n    new NumberField('alpha3', 'Alpha end (0-1)'),\n    new NumberField('size1', 'Size beginning'),\n    new NumberField('size2', 'Size middle'),\n    new NumberField('size3', 'Size end'),\n    new NumberField('acc1', 'Acceleration beginning'),\n    new NumberField('acc2', 'Acceleration middle'),\n    new NumberField('acc3', 'Acceleration end'),\n    new NumberField('ttl', 'Frames to live'),\n    new ImageField('image', 'Image ')];\n\n  readableName = 'ParticleFactory';\n\n  constructor() {\n  }\n\n\n  create(xpos: number, ypos: number, xvel: number, yvel: number, particles: Particle[], deadps: Particle[]) {\n    let p;\n    if (deadps.length > 0) {\n      p = deadps.pop();\n    } else {\n      p = new Particle();\n      particles.push(p);\n    }\n\n    p.x = xpos * this.scaleX;\n    p.y = ypos * this.scaleY;\n    p.vx = xvel * this.scaleX;\n    p.vy = yvel * this.scaleY;\n    p.dead = false;\n    p.ttl = this.ttl;\n    p.pf = this;\n\n  }\n\n  getAlpha(curttl) {\n    const p = (this.ttl - curttl) / this.ttl;\n    if (p < 0.5) {\n      return this.alpha1 * (1 - p * 2) + this.alpha2 * p * 2;\n    } else {\n      return this.alpha2 * (2 - p * 2) + this.alpha3 * (p * 2 - 1);\n    }\n  }\n\n  getSize(curttl) {\n    const p = (this.ttl - curttl) / this.ttl;\n    if (p < 0.5) {\n      return this.size1 * (1 - p * 2) + this.size2 * p * 2;\n    } else {\n      return this.size2 * (2 - p * 2) + this.size3 * (p * 2 - 1);\n    }\n  }\n\n  saveState() {\n    const res = {};\n    for (const field of this.fields) {\n      res[field.key] = this[field.key];\n    }\n    return res;\n  }\n\n\n  restoreState(state) {\n    for (const key in state) {\n      this[key] = state[key];\n    }\n  }\n}\n","export interface Field {\n  type: string;\n}\n\nexport class NumberField implements Field {\n  type = 'number';\n  constructor(public key: string, public name: string) {\n  }\n}\n\nexport class ImageField implements Field {\n  type = 'image';\n  constructor(public key: string, public name: string) {\n  }\n}\n","import {EventEmitter, Injectable} from '@angular/core';\nimport {Layer, LayerType} from './layer';\nimport {drawCanvasToCanvas} from './utils';\nimport {MorphLayer} from './morphlayer';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ProjectDataService {\n\n  layers: Layer[] = [];\n  curLayer: Layer;\n\n  editorImage: HTMLCanvasElement;\n\n  curColor = '#808080';\n  curZoom = 1;\n  curScrollLeft = 0;\n  curScrollTop = 0;\n\n  public drawSize = 20;\n\n  width = 512;\n  height = 512;\n\n  windowChanged = new EventEmitter();\n  layerSelectionChange = new EventEmitter();\n  layerContentChange = new EventEmitter();\n  blurEmitter = new EventEmitter<number>();\n\n  renderedFrameEmitter = new EventEmitter();\n\n  constructor() {\n    /*this.layers.push(new Layer('Layer ' + this.layers.length));\n    this.curLayer = this.layers[0];*/\n    this.renderedFrameEmitter = new EventEmitter();\n  }\n\n  setColor(color) {\n    this.curColor = color;\n  }\n\n  setZoom(zoom) {\n    this.curZoom = zoom;\n    this.windowChanged.emit();\n  }\n\n  addLayer(layer: Layer) {\n    this.layers.push(layer);\n\n    if (layer.type === LayerType.MorphLayer) {\n      this.width = (layer as MorphLayer).getImage().width;\n      this.height = (layer as MorphLayer).getImage().height;\n    }\n    setTimeout(() => this.selectLayer(layer), 100);\n    setTimeout(() => this.selectLayer(layer), 200);\n    this.saveState();\n  }\n\n  selectLayer(layer: Layer) {\n    this.curLayer = layer;\n    if (this.curLayer.type === LayerType.MorphLayer) {\n      this.editorImage = (this.curLayer as MorphLayer).getFlowmap();\n    }\n    this.layerSelectionChange.emit();\n    this.saveState();\n  }\n\n  setFlowMap(canvas: any) {\n    if (this.curLayer.type === LayerType.MorphLayer) {\n      drawCanvasToCanvas(canvas, (this.curLayer as MorphLayer).getFlowmap());\n      (this.curLayer as MorphLayer).setFlowmap((this.curLayer as MorphLayer).getFlowmap());\n      this.layerContentChange.emit();\n    }\n    this.saveState();\n  }\n\n  blurLayer(radius) {\n    this.blurEmitter.emit(radius);\n    this.saveState();\n  }\n\n  saveState() {\n    const layerState = [];\n    for (const layer of this.layers) {\n      layerState.push(layer.saveState());\n    }\n\n    const state = {\n      width: this.width,\n      height: this.height,\n      layers: layerState\n    };\n\n    console.log(state);\n  }\n\n  deleteCurrentLayer() {\n    if (this.curLayer) {\n      if (confirm('Are you sure you want to continue deleting this layer?')) {\n        for (let i = this.layers.length - 1; i >= 0; i--) {\n          if (this.layers[i] === this.curLayer) {\n            this.layers.splice(i, 1);\n            if (this.layers.length > 0) {\n              this.selectLayer(this.layers[Math.max(0, i - 1)]);\n            } else {\n              this.selectLayer(null);\n            }\n          }\n        }\n      }\n    }\n  }\n\n  moveLayerDown() {\n    for (let i = this.layers.length - 1; i >= 0; i--) {\n      if (this.layers[i] === this.curLayer) {\n        if (this.layers.length > 1 && i > 0) {\n          this.layers[i] = this.layers[i - 1];\n          this.layers[i - 1] = this.curLayer;\n          break;\n        }\n      }\n    }\n    this.layerContentChange.emit();\n  }\n\n  moveLayerUp() {\n    for (let i = this.layers.length - 1; i >= 0; i--) {\n      if (this.layers[i] === this.curLayer) {\n        if (this.layers.length > 1 && i < this.layers.length - 1) {\n          this.layers[i] = this.layers[i + 1];\n          this.layers[i + 1] = this.curLayer;\n          break;\n        }\n      }\n    }\n    this.layerContentChange.emit();\n  }\n}\n","export function createDefaultImage(width, height) {\n  const tcanvas = document.createElement('canvas');\n  tcanvas.width = width;\n  tcanvas.height = height;\n  const tctx = tcanvas.getContext('2d');\n  tctx.fillStyle = '#808080';\n  tctx.fillRect(0, 0, tcanvas.width, tcanvas.height);\n\n  return tcanvas;\n}\n\nexport function drawCanvasToCanvas(from, to) {\n  to.width = from.width;\n  to.height = from.height;\n  const tctx = to.getContext('2d');\n  tctx.fillStyle = '#808080';\n  tctx.drawImage(from, 0, 0);\n}\n\nexport function imageUrlToCanvas(url) {\n  const img = new Image();\n  const tcanvas = document.createElement('canvas');\n  img.onload = () => {\n    tcanvas.width = img.width;\n    tcanvas.height = img.height;\n    const tctx = tcanvas.getContext('2d');\n    tctx.drawImage(img, 0, 0);\n  };\n  img.src = url;\n  return tcanvas;\n}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3Rvb2wtcGFuZWwvZGlyZWN0aW9uLWNvbG9yLXBpY2tlci9kaXJlY3Rpb24tY29sb3ItcGlja2VyLmNvbXBvbmVudC5jc3MifQ== */\"","import {AfterViewInit, Component, ElementRef, EventEmitter, OnInit, Output, ViewChild} from '@angular/core';\nimport {ProjectDataService} from '../../services/project-data.service';\n\n@Component({\n  selector: 'app-direction-color-picker',\n  templateUrl: './direction-color-picker.component.html',\n  styleUrls: ['./direction-color-picker.component.css']\n})\nexport class DirectionColorPickerComponent implements OnInit, AfterViewInit {\n  @ViewChild('canvas', {static: false, read: ElementRef}) flowCanvas: ElementRef;\n  ctx: CanvasRenderingContext2D;\n  width = 100.0;\n\n  @Output() color = new EventEmitter<string>();\n\n  constructor(private pds: ProjectDataService) {\n  }\n\n  updateImage() {\n    this.flowCanvas.nativeElement.width = this.width;\n    this.flowCanvas.nativeElement.height = this.width;\n    this.ctx = this.flowCanvas.nativeElement.getContext('2d');\n    this.ctx.fillStyle = '#808080';\n    this.ctx.fillRect(0, 0, this.flowCanvas.nativeElement.width, this.flowCanvas.nativeElement.height);\n    for (let d = 0; d < 360; d++) {\n      for (let r = this.width / 2; r >= 0 ; r--) {\n        this.ctx.beginPath();\n        this.ctx.moveTo(this.width / 2, this.width / 2);\n        this.ctx.lineTo(this.width / 2 - Math.cos(d / Math.PI * 180) * r, this.width / 2 - Math.sin(d / Math.PI * 180) * r);\n\n        let scale = (r) / (this.width / 2) * 128;\n        this.ctx.strokeStyle = 'rgb(' + (128 + Math.cos(d / Math.PI * 180) * scale) + \",\" + (128 + Math.sin(d / Math.PI * 180) * scale) + ',128)';\n        this.ctx.stroke();\n      }\n    }\n  }\n\n  ngAfterViewInit(): void {\n    this.flowCanvas.nativeElement.addEventListener('mousemove', (ev) => this.mousemove(ev));\n    this.flowCanvas.nativeElement.addEventListener('mousedown', (ev) => this.mousedown(ev));\n    this.flowCanvas.nativeElement.addEventListener('mouseup', (ev) => this.mouseup(ev));\n    this.updateImage();\n  }\n\n  mousemove(event) {\n    const rect = this.flowCanvas.nativeElement.getBoundingClientRect();\n    const mouseX = event.pageX - rect.left;\n    const mouseY = event.pageY - rect.top;\n  }\n\n  mousedown(event) {\n    const rect = this.flowCanvas.nativeElement.getBoundingClientRect();\n    const mouseX = event.pageX - rect.left;\n    const mouseY = event.pageY - rect.top;\n    let p = this.ctx.getImageData(mouseX, mouseY, 1, 1).data;\n    const selCol = 'rgb(' + p[0] + ',' + p[1] + ',' + p[2] + ')';\n    this.color.emit(selCol);\n    this.pds.setColor(selCol);\n  }\n\n  mouseup(event) {\n  }\n\n  ngOnInit(): void {\n  }\n}\n","export default \"#dialogBack.hidden {\\n  display: none;\\n}\\n\\n#dialogBack {\\n  position: fixed;\\n  left: 0;\\n  top: 0;\\n  width: 100%;\\n  height: 100%;\\n  min-width: 300px;\\n  min-height: 200px;\\n  background: rgba(0,0,0,0.2);\\n  z-index: 1000;\\n  display: grid;\\n}\\n\\n#newLayerDialog {\\n  width: 300px;\\n  margin-right: auto;\\n  padding: 1rem;\\n  background-color: white;\\n}\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvdG9vbC1wYW5lbC90b29sLXBhbmVsLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxhQUFhO0FBQ2Y7O0FBRUE7RUFDRSxlQUFlO0VBQ2YsT0FBTztFQUNQLE1BQU07RUFDTixXQUFXO0VBQ1gsWUFBWTtFQUNaLGdCQUFnQjtFQUNoQixpQkFBaUI7RUFDakIsMkJBQTJCO0VBQzNCLGFBQWE7RUFDYixhQUFhO0FBQ2Y7O0FBRUE7RUFDRSxZQUFZO0VBQ1osa0JBQWtCO0VBQ2xCLGFBQWE7RUFDYix1QkFBdUI7QUFDekIiLCJmaWxlIjoic3JjL2FwcC90b29sLXBhbmVsL3Rvb2wtcGFuZWwuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIiNkaWFsb2dCYWNrLmhpZGRlbiB7XG4gIGRpc3BsYXk6IG5vbmU7XG59XG5cbiNkaWFsb2dCYWNrIHtcbiAgcG9zaXRpb246IGZpeGVkO1xuICBsZWZ0OiAwO1xuICB0b3A6IDA7XG4gIHdpZHRoOiAxMDAlO1xuICBoZWlnaHQ6IDEwMCU7XG4gIG1pbi13aWR0aDogMzAwcHg7XG4gIG1pbi1oZWlnaHQ6IDIwMHB4O1xuICBiYWNrZ3JvdW5kOiByZ2JhKDAsMCwwLDAuMik7XG4gIHotaW5kZXg6IDEwMDA7XG4gIGRpc3BsYXk6IGdyaWQ7XG59XG5cbiNuZXdMYXllckRpYWxvZyB7XG4gIHdpZHRoOiAzMDBweDtcbiAgbWFyZ2luLXJpZ2h0OiBhdXRvO1xuICBwYWRkaW5nOiAxcmVtO1xuICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTtcbn1cbiJdfQ== */\"","import {Component, OnInit} from '@angular/core';\nimport {ProjectDataService} from '../services/project-data.service';\n\n@Component({\n  selector: 'app-tool-panel',\n  templateUrl: './tool-panel.component.html',\n  styleUrls: ['./tool-panel.component.css']\n})\nexport class ToolPanelComponent implements OnInit {\n\n  constructor(private pds: ProjectDataService) {\n  }\n\n  renderLayerVisible = false;\n\n  worker;\n  sampleImageData;\n  sampleVideoData;\n  outputElement;\n  filesElement;\n  running = false;\n  isWorkerLoaded = false;\n  isSupported = (function() {\n    return document.querySelector && window.URL && (window as any).Worker;\n  })();\n\n  ngOnInit() {\n  }\n\n  zoom(factor) {\n    this.pds.setZoom(this.pds.curZoom * factor);\n  }\n\n  changePenSize(event) {\n    console.log(event);\n    this.pds.drawSize = event.target.value;\n  }\n\n  blur() {\n    const radius = parseInt(prompt('Please enter blur radius', '10'), 10);\n    this.pds.blurLayer(radius);\n  }\n\n  renderDialog() {\n    this.renderLayerVisible = true;\n  }\n\n  render() {\n    const time = parseInt((document.getElementById('renderTime') as any).value, 10);\n    const frames = time * 30;\n\n    const images = [];\n    let renderStarted = false;\n\n    const canvas = document.getElementById('CanvasFinal');\n    this.pds.renderedFrameEmitter.subscribe(() => {\n      if (images.length < frames) {\n        const timg = new Image();\n        timg.src = (canvas as any).toDataURL();\n        images.push(timg);\n      } else if (!renderStarted) {\n        renderStarted = true;\n        this.startRender(images);\n        console.log(images);\n      }\n    });\n  }\n\n  startRender(images) {\n    this.initWorker();\n    this.ffmpeg(images);\n  }\n\n  initWorker() {\n    this.outputElement = document.getElementById('outputElement');\n\n    this.worker = new Worker('assets/worker-asm.js');\n    this.worker.onmessage = (event) => {\n      const message = event.data;\n      if (message.type == 'ready') {\n        this.isWorkerLoaded = true;\n        this.worker.postMessage({\n          type: 'command',\n          arguments: ['-help']\n        });\n      } else if (message.type === 'stdout') {\n        //this.outputElement.innerHTML += message.data + '\\n';\n      } else if (message.type === 'start') {\n        //this.outputElement.innerHTML = 'Worker has received command\\n';\n      } else if (message.type === 'done') {\n        const buffers = message.data;\n        if (buffers.length) {\n          this.outputElement.className = 'closed';\n        }\n        buffers.forEach((file) => {\n\n          console.log(this.getDownloadLink(file.data, file.name));\n          this.outputElement.appendChild(this.getDownloadLink(file.data, file.name));\n        });\n      }\n    };\n  }\n\n  parseArguments(text) {\n    text = text.replace(/\\s+/g, ' ');\n    let args = [];\n    // Allow double quotes to not split args.\n    text.split('\"').forEach(function(t, i) {\n      t = t.trim();\n      if ((i % 2) === 1) {\n        args.push(t);\n      } else {\n        args = args.concat(t.split(' '));\n      }\n    });\n    return args;\n  }\n\n  ffmpeg(frames) {\n    const text = '-framerate 30 -i img%03d.jpeg -c:v libx264 -vf fps=25 -pix_fmt yuv420p out.mp4';\n    const args = this.parseArguments(text);\n    console.log(args);\n\n    const tempFiles = [];\n    for (let i = 0; i < frames.length; i++) {\n      tempFiles.push({\n        name: 'img' + this.lpad(i, 3) + '.jpeg',\n        data: this.imagetoUint8(frames[i])\n      });\n    }\n\n\n    this.worker.postMessage({\n      type: 'command',\n      arguments: args,\n      files: tempFiles\n    });\n  }\n\n  lpad(value, padding) {\n    const zeroes = new Array(padding + 1).join('0');\n    return (zeroes + value).slice(-padding);\n  }\n\n  imagetoUint8(img) {\n    const cv = document.createElement('canvas');\n    cv.width = img.naturalWidth; // or 'width' if you want a special/scaled size\n    cv.height = img.naturalHeight; // or 'height' if you want a special/scaled size\n\n    cv.getContext('2d').drawImage(img, 0, 0);\n    const dataUrl = cv.toDataURL('image/jpeg');\n    return this.dataURLtoUint8(dataUrl);\n  }\n\n  dataURLtoFile(dataurl, filename) {\n    let arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1],\n      bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);\n    while (n--) {\n      u8arr[n] = bstr.charCodeAt(n);\n    }\n    return new File([u8arr], filename, {type: mime});\n  }\n\n  dataURLtoUint8(dataurl) {\n    let arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1],\n      bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);\n    while (n--) {\n      u8arr[n] = bstr.charCodeAt(n);\n    }\n    return u8arr;\n  }\n\n  getDownloadLink(fileData, fileName) {\n    if (fileName.match(/\\.jpeg|\\.gif|\\.jpg|\\.png/)) {\n      const blob = new Blob([fileData]);\n      const src = window.URL.createObjectURL(blob);\n      const img = document.createElement('img');\n\n      img.src = src;\n      return img;\n    } else {\n      const a = document.createElement('a');\n      a.download = fileName;\n      const blob = new Blob([fileData]);\n      const src = window.URL.createObjectURL(blob);\n      a.href = src;\n      a.innerHTML = 'Click here to download ' + fileName + '!';\n      return a;\n    }\n  }\n\n  closeDialog(event: MouseEvent) {\n    this.renderLayerVisible = false;\n    event.stopPropagation();\n  }\n}\n","// This file can be replaced during build by using the `fileReplacements` array.\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\n// The list of file replacements can be found in `angular.json`.\n\nexport const environment = {\n  production: false\n};\n\n/*\n * For easier debugging in development mode, you can import the following file\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\n *\n * This import should be commented out in production mode because it will have a negative impact\n * on performance if an error is thrown.\n */\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n"],"sourceRoot":"webpack:///"}